"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_failbot_failbot_ts","ui_packages_failbot_failbot_ts-ui_packages_markdown-viewer_NewMarkdownViewer_tsx"],{7799:(e,t,n)=>{let r;function i(){if(!r)throw Error("Client env was requested before it was loaded. This likely means you are attempting to use client env at the module level in SSR, which is not supported. Please move your client env usage into a function.");return r}function s(){return r?.locale??"en-US"}function a(){return!!i().login}n.d(t,{JK:()=>s,M3:()=>a,_$:()=>i});!function(){if("undefined"!=typeof document){let e=document.getElementById("client-env");if(e)try{r=JSON.parse(e.textContent||"")}catch(e){console.error("Error parsing client-env",e)}}}()},32475:(e,t,n)=>{n.d(t,{G:()=>i,K:()=>s});var r=n(96679);let i=r.XC?.readyState==="interactive"||r.XC?.readyState==="complete"?Promise.resolve():new Promise(e=>{r.XC?.addEventListener("DOMContentLoaded",()=>{e()})}),s=r.XC?.readyState==="complete"?Promise.resolve():new Promise(e=>{r.cg?.addEventListener("load",e)})},22353:(e,t,n)=>{n.d(t,{N7:()=>y});var r=n(36301),i=n(77065),s=n(24212);function a(e){return(0,s.q)(e.stack||"").map(e=>({filename:e.file||"",function:String(e.methodName),lineno:(e.lineNumber||0).toString(),colno:(e.column||0).toString()}))}function l(e){let t=document.querySelectorAll(e);if(t.length>0)return t[t.length-1]}var o=n(43827),c=n(96679),u=n(78284),d=n(27851),m=n(62053);let f=!1,h=0,p=Date.now(),g=new Set(["AbortError","AuthSessionExpiredError","TypeError"]),k=new Set(["Failed to fetch","NetworkError when attempting to fetch resource.","Unable to perform this operation. Please try again later."]);function y(e,t={}){if(!(e instanceof Error||"object"==typeof e&&null!==e&&"name"in e&&"string"==typeof e.name&&"message"in e&&"string"==typeof e.message)){if(function(e){if(!e||"boolean"==typeof e||"number"==typeof e)return!0;if("string"==typeof e){if(S.some(t=>e.includes(t)))return!0}else if("object"==typeof e&&"string"==typeof e.message&&"number"==typeof e.code)return!0;return!1}(e))return;let n=Error(),r=function(e){try{return JSON.stringify(e)}catch{return"Unserializable"}}(e);v(b({type:"UnknownError",value:`Unable to report error, due to a thrown non-Error type: ${typeof e}, with value ${r}`,stacktrace:a(n),catalogService:document.head?.querySelector('meta[name="current-catalog-service"]')?.content},t));return}e.name&&("AbortError"===e.name||g.has(e.name)&&k.has(e.message)||e.name.startsWith("ApiError")&&k.has(e.message))||v(b({type:e.name,value:e.message,stacktrace:a(e),catalogService:e.catalogService||document.head?.querySelector('meta[name="current-catalog-service"]')?.content},t))}async function v(e){if(!(!x&&!f&&h<10&&(0,i.TT)()))return;let t=document.head?.querySelector('meta[name="browser-errors-url"]')?.content;if(t){if(e.error.stacktrace.some(e=>w.test(e.filename)||w.test(e.function))){f=!0;return}h++;try{await fetch(t,{method:"post",body:JSON.stringify({context:e,target:document.head?.querySelector('meta[name="ui-target"]')?.content||"full"})})}catch{}}}function b(e,t={}){let n={...t};return(0,d.G7)("failbot_report_error_react_apps_on_page")&&!n.reactAppName&&(n.reactAppName=function(e){let t=function(){let e=new Set;for(let[t,n]of I)for(let r of document.querySelectorAll(t))if(r instanceof HTMLElement){let t=r.getAttribute(n);t&&e.add(t)}return Array.from(e)}();if(!t||!t.length||!e||!e.length)return;let n=new Set;for(let r of e){if(!r||!r.filename)continue;let e=r.filename.split(/[\\/]/).pop();if(!e||n.has(e))continue;n.add(e);let i=t.find(t=>e.toLowerCase().includes(t.toLowerCase()));if(i)return i}}(e.stacktrace)),Object.assign({error:e,sanitizedUrl:`${window.location.protocol}//${window.location.host}${function(){let e=l("meta[name=analytics-location]");return e?e.content:window.location.pathname}()+function(){let e=l("meta[name=analytics-location-query-strip]"),t="";e||(t=window.location.search);let n=l("meta[name=analytics-location-params]");for(let e of(n&&(t+=(t?"&":"?")+n.content),document.querySelectorAll("meta[name=analytics-param-rename]"))){let n=e.content.split(":",2);t=t.replace(RegExp(`(^|[?&])${n[0]}($|=)`,"g"),`$1${n[1]}$2`)}return t}()}`||window.location.href,readyState:document.readyState,referrer:(0,u.dR)(),timeSinceLoad:Math.round(Date.now()-p),user:function(){let e=document.head?.querySelector('meta[name="user-login"]')?.content;if(e)return e;let t=(0,r.y)();return`anonymous-${t}`}()||void 0,actorId:document.head?.querySelector('meta[name="octolytics-actor-id"]')?.content,bundler:o.v,ui:!!document.querySelector('meta[name="ui"]'),release:document.head?.querySelector('meta[name="release"]')?.content,pastRequestIds:(0,m.xA)()},n)}let w=/(chrome|moz|safari)-extension:\/\//,x=!1;c.cg?.addEventListener("pageshow",()=>x=!1),c.cg?.addEventListener("pagehide",()=>x=!0),"function"==typeof BroadcastChannel&&new BroadcastChannel("shared-worker-error").addEventListener("message",e=>{y(e.data.error)});let S=["Object Not Found Matching Id","Not implemented on this platform","provider because it's not your default extension"],I=[["react-app","app-name"],["react-partial","partial-name"]]},27851:(e,t,n)=>{n.d(t,{G7:()=>o,XY:()=>c,fQ:()=>l});var r=n(5225),i=n(7799);function s(){return new Set((0,i._$)().featureFlags)}let a=n(96679).X3||function(){try{return process?.env?.STORYBOOK==="true"}catch{return!1}}()?s:(0,r.A)(s);function l(){return Array.from(a())}function o(e){return a().has(e)}let c={isFeatureEnabled:o}},62053:(e,t,n)=>{n.d(t,{Ex:()=>a,kt:()=>o,xA:()=>l});var r=n(96679);let i=Array(10).fill(null),s=0;function a(e){i[s]=e,s=(s+1)%10}function l(){let e=[];for(let t=0;t<10;t++){let n=i[(s-1-t+10)%10];n&&e.push(n)}return e}function o(){let e=r.XC;if(!e)return;let t=e.querySelector('meta[name="request-id"]'),n=t?.getAttribute("content");n&&a(n)}},43827:(e,t,n)=>{n.d(t,{k:()=>a,v:()=>l});var r=n(5225),i=n(96679);let s=(0,r.A)(function(){return i.XC?.head?.querySelector('meta[name="runtime-environment"]')?.content||""}),a=(0,r.A)(function(){return"enterprise"===s()}),l="webpack"},85351:(e,t,n)=>{n.d(t,{A:()=>a,D:()=>l});var r=n(96679),i=n(7479);let s=class NoOpStorage{getItem(){return null}setItem(){}removeItem(){}clear(){}key(){return null}get length(){return 0}};function a(e,t={throwQuotaErrorsOnSet:!1},n=r.cg,l=e=>e,o=e=>e){let c;try{if(!n)throw Error();c=n[e]||new s}catch{c=new s}let{throwQuotaErrorsOnSet:u}=t;function d(e){t.sendCacheStats&&(0,i.i)({incrementKey:e})}function m(e){try{if(c.removeItem(e),t.ttl){let t=`${e}:expiry`;c.removeItem(t)}}catch{}}return{getItem:function(e,t=Date.now()){try{let n=c.getItem(e);if(!n)return null;let r=`${e}:expiry`,i=Number(c.getItem(r));if(i&&t>i)return m(e),m(r),d("SAFE_STORAGE_VALUE_EXPIRED"),null;return d("SAFE_STORAGE_VALUE_WITHIN_TTL"),l(n)}catch{return null}},setItem:function(e,n,r=Date.now()){try{if(c.setItem(e,o(n)),t.ttl){let n=`${e}:expiry`,i=r+t.ttl;c.setItem(n,i.toString())}}catch(e){if(u&&e instanceof Error&&e.message.toLowerCase().includes("quota"))throw e}},removeItem:m,clear:c.clear,getKeys:function(){return Object.keys(c)},get length(){return c.length}}}function l(e){return a(e,{throwQuotaErrorsOnSet:!1},r.cg,JSON.parse,JSON.stringify)}},24852:(e,t,n)=>{n.d(t,{Ai:()=>s,Gq:()=>r,SO:()=>i});let{getItem:r,setItem:i,removeItem:s}=(0,n(85351).A)("sessionStorage")},78284:(e,t,n)=>{n.d(t,{BW:()=>i,Ff:()=>f,HK:()=>v,JA:()=>L,LM:()=>h,Pv:()=>x,Vy:()=>m,ZW:()=>w,dR:()=>b,di:()=>p,fX:()=>S,gc:()=>I,k9:()=>y,my:()=>k,r7:()=>T,wG:()=>g,xT:()=>d});var r=n(24852);let i="reload",s="soft-nav:fail",a="soft-nav:fail-referrer",l="soft-nav:referrer",o="soft-nav:marker",c="soft-nav:react-app-name",u="soft-nav:latest-mechanism";function d(){(0,r.SO)(o,"0"),(0,r.Ai)(l),(0,r.Ai)(s),(0,r.Ai)(a),(0,r.Ai)(c),(0,r.Ai)(u)}function m(e){(0,r.SO)(o,e)}function f(){(0,r.SO)(o,"0")}function h(){let e=(0,r.Gq)(o);return e&&"0"!==e}function p(){return(0,r.Gq)(o)}function g(){return!!k()}function k(){return(0,r.Gq)(s)}function y(e){(0,r.SO)(s,e||i),(0,r.SO)(a,window.location.href)}function v(){(0,r.SO)(l,window.location.href)}function b(){return(0,r.Gq)(l)||document.referrer}function w(){let e=S();e?(0,r.SO)(c,e):(0,r.Ai)(c)}function x(){return(0,r.Gq)(c)}function S(){return document.querySelector('react-partial[partial-name="repos-overview"]')?"repos-overview":document.querySelector("react-app")?.getAttribute("app-name")}function I(){return!!document.querySelector("react-app")?.getAttribute("app-name")}function L(e){(0,r.SO)(u,e)}function T(){return(0,r.Gq)(u)}},96679:(e,t,n)=>{n.d(t,{KJ:()=>r.KJ,Kn:()=>i.Kn,X3:()=>r.X3,XC:()=>i.XC,cg:()=>i.cg,fV:()=>i.fV,g5:()=>r.g5});var r=n(28583),i=n(46570)},46570:(e,t,n)=>{n.d(t,{Kn:()=>a,XC:()=>i,cg:()=>s,fV:()=>l});let r="undefined"!=typeof FORCE_SERVER_ENV&&FORCE_SERVER_ENV,i="undefined"==typeof document||r?void 0:document,s="undefined"==typeof window||r?void 0:window,a="undefined"==typeof history||r?void 0:history,l="undefined"==typeof location||r?{pathname:"",origin:"",search:"",hash:"",href:""}:location},28583:(e,t,n)=>{n.d(t,{KJ:()=>s,X3:()=>i,g5:()=>a});var r=n(46570);let i=void 0===r.XC,s=!i;function a(){return!!i||!r.XC||!!(r.XC.querySelector('react-app[data-ssr="true"]')||r.XC.querySelector('react-partial[data-ssr="true"][partial-name="repos-overview"]'))}},7479:(e,t,n)=>{n.d(t,{X:()=>h,i:()=>u});var r=n(96679),i=n(32475),s=n(43827),a=n(27851),l=n(7799),o=n(70170);let c=[];function u(e,t=!1,n=.5){if(!r.X3&&!0!==(0,a.G7)("browser_stats_disabled")){if(n<0||n>1)throw RangeError("Sampling probability must be between 0 and 1");void 0===e.timestamp&&(e.timestamp=Date.now()),e.loggedIn=(0,l.M3)(),e.staff=h(),e.bundler=s.v,Math.random()<n&&c.push(e),t?f():m()}}let d=null,m=(0,o.n)(async function(){await i.K,null==d&&(d=window.requestIdleCallback(f))},5e3);function f(){if(d=null,!c.length)return;let e=r.XC?.head?.querySelector('meta[name="browser-stats-url"]')?.content;if(e){for(let i of function(e){let t=[],n=e.map(e=>JSON.stringify(e));for(;n.length>0;)t.push(function(e){let t=e.shift(),n=[t],r=t.length;for(;e.length>0&&r<=65536;){let t=e[0].length;if(r+t<=65536){let i=e.shift();n.push(i),r+=t}else break}return n}(n));return t}(c)){var t=e,n=`{"stats": [${i.join(",")}], "target": "${r.XC?.head?.querySelector('meta[name="ui-target"]')?.content||"full"}"}`;try{navigator.sendBeacon&&navigator.sendBeacon(t,n)}catch{}}c=[]}}function h(){return!!r.XC?.head?.querySelector('meta[name="user-staff"]')?.content}r.XC?.addEventListener("pagehide",f),r.XC?.addEventListener("visibilitychange",f)},26768:(e,t,n)=>{n.d(t,{A:()=>z});var r=n(74848),i=n(63867),s=n(27851),a=n(96540),l=n(45968),o=n(40961),c=n(96222);let u={"task-list-item":"TaskListItems-module__task-list-item--gViR6","numbered-task-list":"TaskListItems-module__numbered-task-list--WRIlb","numbered-task-list-nested":"TaskListItems-module__numbered-task-list-nested--eiXja","unordered-task-list":"TaskListItems-module__unordered-task-list--WS9ke","unordered-task-list-nested":"TaskListItems-module__unordered-task-list-nested--iS6sh","bullet-task-item":"TaskListItems-module__bullet-task-item--CGGup","numbered-task-item":"TaskListItems-module__numbered-task-item--Zjsc8","nested-overlay-list":"TaskListItems-module__nested-overlay-list--DWd6q","overlay-task-list-child":"TaskListItems-module__overlay-task-list-child--q26YD"};var d=n(65607),m=n(30422),f=n(64575);let h=e=>"string"==typeof e?.taskBox&&e?.text?.match(/[^\s\\]/)!==null,p=({container:e,nestedItems:t,globalIndex:n,markdownIndex:r,items:i,itemsData:s,nested:a=!1,lists:l,parentIsChecklist:o,hasDifferentListTypes:c})=>(i.map((i,u)=>{let d=Array.from(i.querySelectorAll(":scope > ul > li:not(.base-task-list-item), :scope > ol > li:not(.base-task-list-item)"))??[],m=Array.from(i.querySelectorAll(":scope > ul > li.task-list-item, :scope > ol > li.task-list-item"))??[],f=(Array.from(i.querySelectorAll("ul > li.task-list-item, ol > li.task-list-item, li.task-list-item"))??[]).length,h=[];f>0&&t.set(n.toString(),f);let g=i.classList.contains("task-list-item")?function(e,t){let n=t.parentElement?.closest(".contains-task-list");if(!n)throw Error("Could not find the item's parent list");let r=t?Array.from(n.children).indexOf(t):-1;return[e.indexOf(n),r]}(l,i):void 0,{title:k,content:y}=function(e){let t="",n="";for(let i of e.childNodes){var r;if("INPUT"===(r=i).nodeName||"UL"===r.nodeName||"OL"===r.nodeName||"#comment"===i.nodeName)continue;let e=i.textContent||"";if("#text"===i.nodeName){t+=e,n+=e;continue}if("CODE"===i.nodeName){t+=`\`${e}\``,n+=i.outerHTML;continue}t+=e,n+=i.outerHTML}return{title:t.trim(),content:n}}(i);s.push({id:n.toString(),index:u,title:k,content:y,checked:i.querySelector(".task-list-item-checkbox")?.checked===!0,position:g,container:i.parentElement,nested:a,children:h,markdownIndex:i.classList.contains("task-list-item")?r+=1:-1,isBullet:i.parentElement?.tagName==="UL"&&!i.classList.contains("task-list-item"),isNumbered:i.parentElement?.tagName==="OL"&&!i.classList.contains("task-list-item"),parentIsChecklist:o,hasNestedItems:f>0,hasDifferentListTypes:c});let v=d.length>0&&p({container:e,nestedItems:t,globalIndex:n+1,markdownIndex:r,items:d,itemsData:h,nested:!0,lists:l,parentIsChecklist:i.classList.contains("task-list-item"),hasDifferentListTypes:m.length>0&&d.length!==m.length});n=v?v.globalIndex:n+1,r=v?v.markdownIndex:r}),{globalIndex:n,markdownIndex:r}),g=async({markdownValue:e,markdownIndex:t,onChange:n})=>{let r=e.split(/\r?\n/),i=null,s=!1;for(let e=0,a=0;e<r.length;e++){let l=r[e];if(l.trim().startsWith("\x3c!--")&&(s=!0),s){l.trim().endsWith("--\x3e")&&(s=!1);continue}if(i){if(v(l,i)){i=null;continue}}else i=y(l);if(i)continue;let o=(0,f.VB)(l);if(h(o)){if(a===t){let t=(0,f.a1)(k(o));r.splice(e,1,t);let i=r.join(`
`);return await n(i)}a++}}},k=e=>({...e,taskBox:"[ ]"===e.taskBox?"[x]":"[ ]"}),y=e=>{let t=e.match(/^ {0,3}(`{3,}|~{3,})[^`]*$/);return t?t[1]:null},v=(e,t)=>RegExp(`^ {0,3}${t}${t[0]}* *$`).test(e),b={"task-list-item":"TaskListItem-module__task-list-item--hncv0",disabled:"TaskListItem-module__disabled--rVvkq","no-convert-task-list-item":"TaskListItem-module__no-convert-task-list-item--h_Byp","left-aligned-content":"TaskListItem-module__left-aligned-content--PRNTb","checkbox-items":"TaskListItem-module__checkbox-items--F0Yz2","drag-drop-container":"TaskListItem-module__drag-drop-container--ivNfi","drag-handle-icon":"TaskListItem-module__drag-handle-icon--WPdxE","show-trigger":"TaskListItem-module__show-trigger--pr6Zf","task-list-html":"TaskListItem-module__task-list-html--PQxW3",taskStatusCheckbox:"TaskListItem-module__taskStatusCheckbox--ANT4s",TaskListItemActionsContainer:"TaskListItem-module__TaskListItemActionsContainer--Dd_tK"};var w=n(10569),x=n(87330),S=n(15385),I=n(38621);let L={convertToIssue:"Convert to issue",convertToSubIssue:"Convert to sub-issue",moveUp:"Move up",moveDown:"Move down",openTaskOptions:e=>`Open ${e} task options`},T={TaskListMenuTriggerButton:"TaskListMenu-module__TaskListMenuTriggerButton--GR2W2"},_=({totalItems:e,onConvertToIssue:t,onConvertToSubIssue:n,item:i,allowIssueConversion:s,allowSubIssueConversion:l,disabled:o,setIsConverting:u,allowReordering:d,...m})=>{let{title:f,index:h,id:p}=i,{moveToPosition:g}=(0,c.gY)(),[k,y]=(0,a.useState)(!1),v=(0,a.useMemo)(()=>`task-list-menu-item-${p}`,[p]),b=e=>{if(e){let e=Array.from(document.querySelectorAll('[id^="task-list-menu-item-"]'));if(e.length>0){let t=e[Math.min(h,e.length-1)];t?.focus()}}else{let e=document.getElementById(v);e&&e.focus()}},_=({moveAction:e,e:t})=>{switch(t.preventDefault(),t.stopPropagation(),y(!1),e){case"up":g(h,h-1,!0);break;case"down":g(h,h+1,!1)}},N=({e,move:r,convertToIssue:s,convertToSubIssue:a})=>{e.preventDefault(),e.stopPropagation(),"Enter"===e.code&&r&&_({moveAction:r,e}),"Enter"===e.code&&s&&(y(!1),t?.(i,u,()=>{b(!1)})),"Enter"===e.code&&a&&(y(!1),n?.(i,u,()=>{b(!0)})),"Escape"===e.code&&y(!1)};return(0,r.jsxs)(w.W,{open:k,onOpenChange:y,children:[(0,r.jsx)(w.W.Anchor,{id:v,children:(0,r.jsx)(x.K,{"data-testid":m["data-testid"],icon:I.KebabHorizontalIcon,variant:"invisible","aria-label":L.openTaskOptions(f),disabled:o,className:T.TaskListMenuTriggerButton})}),(0,r.jsx)(w.W.Overlay,{children:(0,r.jsxs)(S.l,{children:[d&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(S.l.Item,{onClick:e=>_({moveAction:"up",e}),onKeyDown:e=>N({e,move:"up"}),disabled:0===h,children:[(0,r.jsx)(S.l.LeadingVisual,{children:(0,r.jsx)(I.ChevronUpIcon,{})}),L.moveUp]}),(0,r.jsxs)(S.l.Item,{onClick:e=>_({moveAction:"down",e}),onKeyDown:e=>N({e,move:"down"}),disabled:h===e-1,children:[(0,r.jsx)(S.l.LeadingVisual,{children:(0,r.jsx)(I.ChevronDownIcon,{})}),L.moveDown]})]}),s&&t&&(0,r.jsxs)(S.l.Item,{onClick:()=>t?.(i,u),onKeyDown:e=>N({e,convertToIssue:!0}),"data-testid":m["data-testid"]&&`${m["data-testid"]}-convert`,children:[(0,r.jsx)(S.l.LeadingVisual,{children:(0,r.jsx)(I.IssueOpenedIcon,{})}),L.convertToIssue]}),l&&n&&(0,r.jsxs)(S.l.Item,{onClick:()=>n?.(i,u),onKeyDown:e=>N({e,convertToSubIssue:!0}),"data-testid":m["data-testid"]&&`${m["data-testid"]}-convert-sub-issue`,children:[(0,r.jsx)(S.l.LeadingVisual,{children:(0,r.jsx)(I.IssueTracksIcon,{})}),L.convertToSubIssue]})]})})]})};try{_.displayName||(_.displayName="TaskListMenu")}catch{}let N={ADD_TAGS:["math-renderer"],ADD_ATTR:["style","data-run-id","data-catalyst","class"]},C=/\/issues\/\d*\d/,A=(e,t)=>{let n=document.createElement("div");n.innerHTML=e;let r=n.querySelectorAll("span.reference");if(0===r.length)return!0;if(t||r.length>1)return!1;let i=r[0];return i.remove(),""===n.innerHTML.trim()&&!!C.test(i.innerHTML)};function E({markdownValue:e,onChange:t,onConvertToIssue:n,onConvertToSubIssue:s,nested:l=!1,position:o=1,item:u,totalItems:f,disabled:h,hideActions:p,itemIdToFocus:k,setitemIdToFocus:y,toggledItem:v,setToggledItem:w}){let[x,S]=(0,a.useState)(u.checked),[I,L]=(0,a.useState)(!1),[T,C]=(0,a.useState)(!1),E=e=>{let t=document.getElementById(`task-list-menu-item-${e}`);t&&t.focus()};(0,a.useEffect)(()=>{k&&!h&&(E(k),y?.(null))},[k,h,y]),(0,a.useEffect)(()=>{v&&!h&&w(null)},[v,h,w]);let j=(0,a.useCallback)(e=>{S(!u.checked),w(u.id),g({markdownValue:e,markdownIndex:u.markdownIndex,onChange:t})},[u,t,w]),$=!l&&!u.hasDifferentListTypes||l&&o<2&&!u.parentIsChecklist&&!u.hasDifferentListTypes,[O,q]=(0,a.useMemo)(()=>[A(u.content,!0),A(u.content,!1)],[u.content]),D=`tasklist-item-${o}-${u.markdownIndex}`,M=!l||n&&s?b["task-list-item"]:b["no-convert-task-list-item"];return M+=` ${l&&f>0?"contains-task-list":""}`,M+=h?` ${b.disabled}`:"",(0,r.jsxs)("div",{className:M,onMouseEnter:()=>L(!0),onMouseLeave:()=>L(!1),"data-testid":D,children:[(0,r.jsxs)("div",{className:b["left-aligned-content"],children:[(0,r.jsx)("div",{className:b["drag-drop-container"],children:$&&!h&&(0,r.jsx)(c.BS.DragTrigger,{className:`${b["drag-handle-icon"]} ${I?b["show-trigger"]:""}`,style:{width:"20px",height:"28px"}})}),(0,r.jsxs)("div",{className:b["checkbox-items"],id:`checkbox-item-${u.id}`,children:[(0,r.jsx)(d.A,{autoFocus:u.id===v,checked:x,disabled:h,onChange:t=>{t.preventDefault(),t.stopPropagation(),j(e)},"aria-label":`${u.title} checklist item`,className:b.taskStatusCheckbox}),(0,r.jsx)(m.JU,{html:u.content,className:b["task-list-html"],domPurifyConfig:N})]})]}),(0,r.jsxs)("div",{className:b.TaskListItemActionsContainer,children:[T&&(0,r.jsx)(i.A,{size:"small"}),!p&&$&&u.position&&!T&&(0,r.jsx)(_,{"data-testid":`${D}-menu`,onConvertToIssue:n,onConvertToSubIssue:s,totalItems:f,item:u,disabled:h,allowIssueConversion:O,allowSubIssueConversion:q,setIsConverting:C,allowReordering:$})]})]})}try{E.displayName||(E.displayName="TaskListItem")}catch{}let j={ListItemContent:"ListItem-module__ListItemContent--v9OGu"};function $({item:e,position:t}){let n=`tasklist-item-${t}-${e.markdownIndex}`;return(0,r.jsx)(m.Pk,{html:e.content,as:"div","data-testid":n,className:j.ListItemContent})}try{$.displayName||($.displayName="ListItem")}catch{}let O=(e,t,n,r,i,s)=>{let a=new Map(r),l=e.findIndex(e=>e.id===t),o=e[l];if(!o)return a;let c=[...e];c.splice(l,1);let u=c.findIndex(e=>e.id===n);c.splice(i?u:u+1,0,o);let d=r.get(s);if(!d)return a;if(d===e)a.set(s,c);else{let t=n=>{for(let r of n)r.children===e?r.children=c:r.children&&t(r.children)};t(d),a.set(s,d)}return a},q=(e,t,n,r)=>{let{startLineNumber:i,endLineNumber:s}=D(n,e),{startLineNumber:a,endLineNumber:l}=D(r,e),o=e.split(/\r?\n/),c=s-i+1,u=[...o].splice(i,c);return t?(o.splice(i,c),o.splice(a,0,...u)):(o.splice(l+1,0,...u),o.splice(i,c)),o.join(`
`)},D=(e,t)=>{let n,r=t.split(/\r?\n/),i=-1,s=-1,a=-1;for(let[t,l]of r.entries()){let r=(0,f.VB)(l),o=r?.leadingWhitespace.length;if(n&&(!l||void 0!==o&&o<=n.leadingWhitespace.length)){s=t>0?t-1:0;break}r&&h(r)&&++a===e&&(i=t,n=r)}return{startLineNumber:i,endLineNumber:s=-1===s?r.length-1:s}},M=({tasklists:e,markdownValue:t,externalOnChange:n,onConvertToIssue:i,onConvertToSubIssue:s,tasklistData:l,setTasklistData:d,disabled:m,viewerCanUpdate:f})=>{let[h,p]=(0,a.useState)(!1),[g,k]=(0,a.useState)(null),[y,v]=(0,a.useState)(null),b=(0,a.useCallback)(async({dragMetadata:e,dropMetadata:r,isBefore:i,items:s,container:a})=>{if(e.id===r?.id||m)return;p(!0);let o=s.find(t=>t.id===e.id)?.markdownIndex,c=s.find(e=>e.id===r.id)?.markdownIndex;if(void 0===o||void 0===c)return;let u=q(t,i,o,c);d(O(s,e.id,r.id,l,i,a)),n&&(await n(u),p(!1),k(r.id))},[m,t,l,d,n]),w=(0,a.useCallback)(async e=>{n&&(p(!0),await n(e),p(!1))},[n]);function x(e,n,l,o,d,p){let S=!e.isBullet&&!e.isNumbered,I="OL"===l.tagName?"ol":"UL"===l.tagName?"ul":"div";return(0,r.jsxs)(a.Fragment,{children:[S&&(0,r.jsx)(E,{toggledItem:y,setToggledItem:v,markdownValue:t,onChange:w,onConvertToIssue:i,onConvertToSubIssue:s,nested:d,position:n,item:e,totalItems:o,disabled:m||h,hideActions:!f&&!h,setitemIdToFocus:k,itemIdToFocus:g}),!S&&(0,r.jsx)($,{item:e,position:n}),e.children.length>0&&(0,r.jsx)(c.BS,{items:e.children,onDrop:t=>b({...t,items:e.children,container:l}),renderOverlay:(t,i)=>(0,r.jsx)(c.BS.Item,{index:i,id:t.id,title:t.title,hideTrigger:!0,className:u["task-list-item"],isDragOverlay:!0,style:{marginLeft:"-30px"},children:x(t,n+1,l,e.children.length,!0,!0)},t.id),as:"div",children:(0,r.jsx)(I,{className:"base-list-item",style:{listStyleType:"none",marginLeft:S?"12px":"-28px"},children:e.children.map((t,i)=>{let s=B({child:t,position:n}),a=R({child:t,isDragOverlay:p}),o=X({child:t,isDragOverlay:p});return(0,r.jsx)(c.BS.Item,{index:i,id:t.id,title:t.title,hideTrigger:!0,className:`${s} ${a} ${o}`,as:V(e)?"li":"div",children:x(t,n+1,l,e.children.length,!0,p)},t.id)})})})]},e.index)}return(0,a.useMemo)(()=>(0,r.jsx)(r.Fragment,{children:e.map((e,t)=>{let n=l.get(e)||[],i=n.filter(e=>!e.isBullet&&!e.isNumbered),s="OL"===e.tagName?"ol":"UL"!==e.tagName||e.classList.contains("contains-task-list")&&i.length===n.length?"div":"ul";return n.length>0?(0,o.createPortal)((0,r.jsx)("li",{className:"base-task-list-item",style:{listStyle:"none",marginLeft:"-28px"},children:(0,r.jsx)(c.BS,{items:n,onDrop:t=>b({...t,items:n,container:e}),style:{marginTop:"1px"},renderOverlay:(t,i)=>(0,r.jsx)(c.BS.Item,{index:i,id:t.id,title:t.title,hideTrigger:!0,isDragOverlay:!0,children:x(t,0,e,n.length,!1,!0)},t.id),as:"div",children:(0,r.jsx)(s,{className:"base-list-item",style:{marginLeft:i.length!==n.length&&i.length?"5px":"0px"},children:n.map((t,i)=>(0,r.jsx)(c.BS.Item,{index:i,id:t.id,title:t.title,hideTrigger:!0,className:t.isBullet?u["bullet-task-item"]:t.isNumbered?u["numbered-task-item"]:u["task-list-item"],as:V(t)?"li":"div",style:{marginLeft:t.isBullet||t.isNumbered||!t.hasDifferentListTypes?"0px":"-28px",marginRight:"-8px"},children:x(t,0,e,n.length,!1,!1)},t.id))})})}),e,t.toString()):null})}),[t,l,m])},B=({child:e,position:t})=>e.isNumbered?t+1<2?u["numbered-task-list"]:u["numbered-task-list-nested"]:e.isBullet?t+1<2?u["unordered-task-list"]:u["unordered-task-list-nested"]:u["task-list-item"],R=({child:e,isDragOverlay:t})=>!e.isBullet&&!e.isNumbered&&(t?u["nested-overlay-list"]:e.parentIsChecklist||e.hasDifferentListTypes?"":u["task-list-item"]),X=({child:e,isDragOverlay:t})=>(e.isBullet||e.isNumbered)&&(t?u["overlay-task-list-child"]:""),V=e=>(e.isNumbered||e.isBullet)&&!e.hasDifferentListTypes||e.hasDifferentListTypes||e.children.length>0;try{M.displayName||(M.displayName="TaskListItems")}catch{}let K={spinner:"NewMarkdownViewer-module__spinner--2QW6e","safe-html-box":"NewMarkdownViewer-module__safe-html-box--cRsz0"};var P=n(34164),G=n(17515);let U=[],W=function(e,t,n){let[r,i]=(0,a.useState)([]);return(0,G.N)(()=>{let n=Array.from(e.current?.querySelectorAll(t)??U);i(e=>!function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(e,n)?n:e)},[n,e,t]),r},F=(e,t)=>{let[n,r]=(0,a.useState)(()=>new Map),[i,s]=(0,a.useState)(()=>new Map);return(0,G.N)(()=>{if(!e)return;let n=function({container:e,tasklists:t}){let n=new Map,r=new Map,i=function(e,t="ul:not(.base-list-item), ol:not(.base-list-item)"){return Array.from(e.querySelectorAll(t)).filter(e=>!e.closest("tracking-block"))}(e),s=0,a=-1;for(let l of t){let t=Array.from(l.querySelectorAll(":scope > li:not(.base-task-list-item)")),o=l.querySelectorAll(":scope > li.task-list-item"),c=[],{globalIndex:u,markdownIndex:d}=p({container:e,nestedItems:r,globalIndex:s,markdownIndex:a,items:t,itemsData:c,nested:!1,lists:i,parentIsChecklist:l.classList.contains("task-list-item"),hasDifferentListTypes:o.length>0&&o.length!==t.length});for(let e of(s=u,a=d,n.set(l,c),t))e.remove()}return{newData:n,nestedItems:r}}({container:e,tasklists:t});r(n.newData),s(n.nestedItems)},[e,t]),{tasklistData:n,nestedItems:i,setTasklistData:r,setNestedItems:s}};var J=n(46847);let H=/\b(href|src)\s*=\s*(['"])([^'"?]{1,2000})(\?(?:[^'"]{0,1000}?))token=([^&#"']{0,500})([^'"]{0,1000})\2/gi,z=({verifiedHTML:e,markdownValue:t="",onChange:n,onConvertToIssue:o,onConvertToSubIssue:c,onLinkClick:u,openLinksInNewTab:d=!1,loading:m=!1,disabled:f,viewerCanUpdate:h,className:p})=>{let g=(0,a.useRef)(null),k=W(g,".contains-task-list:not(.contains-task-list .contains-task-list)",e),y=(0,a.useRef)(""),v=(0,s.G7)("issues_preserve_tokens_in_urls"),b=(0,a.useMemo)(()=>v?function(e,t){H.lastIndex=0;let n=0;return e.replace(H,(e,r,i,s,a,l,o)=>{if(++n>1e3)return e;let c=`${s}${a}token=TOKEN_PLACEHOLDER${o}`;return t.hasOwnProperty(c)?`${r}=${i}${s}${a}token=${t[c]}${o}${i}`:e})}(e,function(e){let t,n={};H.lastIndex=0;let r=0;for(;null!==(t=H.exec(e))&&!(++r>1e3);){let e=t[3],r=t[4],i=t[5],s=t[6];e&&i&&(n[`${e}${r}token=TOKEN_PLACEHOLDER${s}`]=i)}return n}(y.current)):e,[e,v]);y.current=b;let{tasklistData:w,nestedItems:x,setTasklistData:S}=F(g.current,k);(0,J.O)({htmlContainerRef:g,onLinkClick:u,openLinksInNewTab:d});let I=(0,a.useMemo)(()=>{let e=["markdown-body",K["safe-html-box"]];return p&&e.push(p),(0,r.jsx)(l.vb,{ref:g,className:(0,P.$)(e),html:b})},[p,b]);return m?(0,r.jsx)("div",{className:(0,P.$)(K.spinner),children:(0,r.jsx)(i.A,{"aria-label":"Loading markdown content..."})}):(0,r.jsxs)(r.Fragment,{children:[I,k.length>0&&(0,r.jsx)(M,{tasklists:k,markdownValue:t,externalOnChange:n,onConvertToIssue:o,onConvertToSubIssue:c,tasklistData:w,setTasklistData:S,nestedItems:x,disabled:f||!n,viewerCanUpdate:h})]})};try{z.displayName||(z.displayName="NewMarkdownViewer")}catch{}}}]);
//# sourceMappingURL=ui_packages_failbot_failbot_ts-ui_packages_markdown-viewer_NewMarkdownViewer_tsx-4edbdf14314f.js.map